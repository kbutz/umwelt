
<!DOCTYPE html>
<html>
<head>
    <title>Umwelt: Sensory Flow</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/d3-sankey@0.12.3/dist/d3-sankey.min.js"></script>
    <style>
        body { margin: 0; font-family: sans-serif; background: #0f0f0f; color: #eee; }
        .node rect { fill-opacity: 0.9; shape-rendering: crispEdges; stroke-width: 0; }
        .node text { fill: #fff; font-size: 10px; pointer-events: none; }
        .link { fill: none; stroke: #444; stroke-opacity: 0.2; }
        .link:hover { stroke-opacity: 0.5; }
        h1 { text-align: center; color: #00d4ff; }
    </style>
</head>
<body>
    <h1>Sensory Flow: Order → Family → Sense</h1>
    <div id="chart"></div>

    <script>
        const data = {"nodes": [{"name": "Carnivora", "type": "order"}, {"name": "Unknown", "type": "family"}, {"name": "Felidae", "type": "family"}, {"name": "Chemoreception", "type": "modality"}, {"name": "Mechanoreception", "type": "modality"}, {"name": "Photoreception", "type": "modality"}, {"name": "Ursidae", "type": "family"}, {"name": "Canidae", "type": "family"}, {"name": "Mustelidae", "type": "family"}, {"name": "Ixodida", "type": "order"}, {"name": "Ixodidae", "type": "family"}, {"name": "Argasidae", "type": "family"}, {"name": "hygroreception", "type": "modality"}, {"name": "Accipitriformes", "type": "order"}, {"name": "Accipitridae", "type": "family"}, {"name": "None", "type": "order"}, {"name": "Viperidae", "type": "family"}, {"name": "None", "type": "family"}, {"name": "Elephantidae", "type": "family"}, {"name": "Diptera", "type": "order"}, {"name": "Culicidae", "type": "family"}, {"name": "Chironomidae", "type": "family"}, {"name": "Cecidomyiidae", "type": "family"}, {"name": "Ceratopogonidae", "type": "family"}, {"name": "Actinedida", "type": "order"}, {"name": "Harpirhynchidae", "type": "family"}, {"name": "Siphonaptera", "type": "order"}, {"name": "Tungidae", "type": "family"}, {"name": "Rhopalopsyllidae", "type": "family"}, {"name": "Pulicidae", "type": "family"}, {"name": "Leptopsyllidae", "type": "family"}, {"name": "Ctenophthalmidae", "type": "family"}, {"name": "Ceratophyllidae", "type": "family"}, {"name": "Thermoreception", "type": "modality"}, {"name": "Lamniformes", "type": "order"}, {"name": "Pseudocarchariidae", "type": "family"}, {"name": "Odontaspididae", "type": "family"}, {"name": "Electroreception", "type": "modality"}, {"name": "Cretoxyrhinidae", "type": "family"}, {"name": "Hymenoptera", "type": "order"}, {"name": "Formicidae", "type": "family"}, {"name": "Apidae", "type": "family"}, {"name": "Ichneumonidae", "type": "family"}, {"name": "Braconidae", "type": "family"}, {"name": "Primates", "type": "order"}, {"name": "Hominidae", "type": "family"}, {"name": "Cercopithecidae", "type": "family"}, {"name": "Omomyidae", "type": "family"}, {"name": "Oligacanthorhynchida", "type": "order"}, {"name": "Oligacanthorhynchidae", "type": "family"}, {"name": "Cetacea", "type": "order"}, {"name": "Delphinidae", "type": "family"}, {"name": "echolocation", "type": "modality"}, {"name": "Balaenopteridae", "type": "family"}, {"name": "Squalodontidae", "type": "family"}, {"name": "Hyperoodontidae", "type": "family"}, {"name": "Physeteridae", "type": "family"}, {"name": "Trombidiformes", "type": "order"}, {"name": "Scutacaridae", "type": "family"}, {"name": "Erythraeidae", "type": "family"}, {"name": "Syringophilidae", "type": "family"}, {"name": "Ereynetidae", "type": "family"}, {"name": "Sarcoptiformes", "type": "order"}, {"name": "Pterolichidae", "type": "family"}, {"name": "Xolalgidae", "type": "family"}, {"name": "Cheylabididae", "type": "family"}, {"name": "Scheloribatidae", "type": "family"}, {"name": "Strigiformes", "type": "order"}, {"name": "Strigidae", "type": "family"}, {"name": "Tytonidae", "type": "family"}, {"name": "Squamata", "type": "order"}, {"name": "Varanidae", "type": "family"}, {"name": "Falconiformes", "type": "order"}, {"name": "Falconidae", "type": "family"}, {"name": "Gymnotiformes", "type": "order"}, {"name": "Hypopomidae", "type": "family"}, {"name": "Apteronotidae", "type": "family"}, {"name": "Sternopygidae", "type": "family"}, {"name": "Hypocreales", "type": "order"}, {"name": "Cordycipitaceae", "type": "family"}, {"name": "Mesostigmata", "type": "order"}, {"name": "Varroidae", "type": "family"}, {"name": "Laelapidae", "type": "family"}, {"name": "Parasitidae", "type": "family"}], "links": [{"source": 0, "target": 1, "value": 1}, {"source": 0, "target": 2, "value": 1}, {"source": 2, "target": 3, "value": 1}, {"source": 2, "target": 4, "value": 1}, {"source": 2, "target": 5, "value": 1}, {"source": 0, "target": 6, "value": 1}, {"source": 0, "target": 7, "value": 1}, {"source": 7, "target": 3, "value": 1}, {"source": 7, "target": 4, "value": 1}, {"source": 7, "target": 5, "value": 1}, {"source": 0, "target": 8, "value": 1}, {"source": 8, "target": 3, "value": 1}, {"source": 8, "target": 4, "value": 1}, {"source": 8, "target": 5, "value": 1}, {"source": 9, "target": 10, "value": 1}, {"source": 10, "target": 3, "value": 1}, {"source": 10, "target": 4, "value": 1}, {"source": 9, "target": 11, "value": 1}, {"source": 11, "target": 3, "value": 1}, {"source": 11, "target": 4, "value": 1}, {"source": 11, "target": 12, "value": 1}, {"source": 13, "target": 14, "value": 1}, {"source": 14, "target": 3, "value": 1}, {"source": 14, "target": 4, "value": 1}, {"source": 14, "target": 5, "value": 1}, {"source": 13, "target": 1, "value": 1}, {"source": 15, "target": 16, "value": 1}, {"source": 15, "target": 1, "value": 1}, {"source": 15, "target": 17, "value": 1}, {"source": 15, "target": 18, "value": 1}, {"source": 18, "target": 3, "value": 1}, {"source": 18, "target": 4, "value": 1}, {"source": 18, "target": 5, "value": 1}, {"source": 19, "target": 20, "value": 1}, {"source": 19, "target": 21, "value": 1}, {"source": 21, "target": 3, "value": 1}, {"source": 21, "target": 4, "value": 1}, {"source": 21, "target": 5, "value": 1}, {"source": 19, "target": 22, "value": 1}, {"source": 22, "target": 3, "value": 1}, {"source": 22, "target": 4, "value": 1}, {"source": 22, "target": 5, "value": 1}, {"source": 19, "target": 23, "value": 1}, {"source": 23, "target": 3, "value": 1}, {"source": 23, "target": 4, "value": 1}, {"source": 23, "target": 5, "value": 1}, {"source": 24, "target": 25, "value": 1}, {"source": 26, "target": 27, "value": 1}, {"source": 26, "target": 28, "value": 1}, {"source": 26, "target": 29, "value": 1}, {"source": 26, "target": 30, "value": 1}, {"source": 30, "target": 3, "value": 1}, {"source": 30, "target": 4, "value": 1}, {"source": 26, "target": 31, "value": 1}, {"source": 31, "target": 3, "value": 1}, {"source": 31, "target": 4, "value": 1}, {"source": 26, "target": 32, "value": 1}, {"source": 32, "target": 3, "value": 1}, {"source": 32, "target": 4, "value": 1}, {"source": 32, "target": 33, "value": 1}, {"source": 34, "target": 35, "value": 1}, {"source": 34, "target": 36, "value": 1}, {"source": 36, "target": 3, "value": 1}, {"source": 36, "target": 37, "value": 1}, {"source": 36, "target": 4, "value": 1}, {"source": 36, "target": 5, "value": 1}, {"source": 34, "target": 38, "value": 1}, {"source": 38, "target": 3, "value": 1}, {"source": 38, "target": 37, "value": 1}, {"source": 38, "target": 4, "value": 1}, {"source": 38, "target": 5, "value": 1}, {"source": 39, "target": 40, "value": 1}, {"source": 39, "target": 41, "value": 1}, {"source": 39, "target": 42, "value": 1}, {"source": 42, "target": 3, "value": 1}, {"source": 42, "target": 4, "value": 1}, {"source": 42, "target": 5, "value": 1}, {"source": 39, "target": 43, "value": 1}, {"source": 43, "target": 3, "value": 1}, {"source": 43, "target": 4, "value": 1}, {"source": 43, "target": 5, "value": 1}, {"source": 44, "target": 45, "value": 1}, {"source": 44, "target": 46, "value": 1}, {"source": 46, "target": 3, "value": 1}, {"source": 46, "target": 4, "value": 1}, {"source": 46, "target": 5, "value": 1}, {"source": 44, "target": 47, "value": 1}, {"source": 47, "target": 3, "value": 1}, {"source": 47, "target": 4, "value": 1}, {"source": 47, "target": 5, "value": 1}, {"source": 48, "target": 49, "value": 1}, {"source": 49, "target": 3, "value": 1}, {"source": 49, "target": 4, "value": 1}, {"source": 50, "target": 1, "value": 1}, {"source": 50, "target": 51, "value": 1}, {"source": 51, "target": 4, "value": 1}, {"source": 51, "target": 5, "value": 1}, {"source": 51, "target": 52, "value": 1}, {"source": 50, "target": 53, "value": 1}, {"source": 53, "target": 4, "value": 1}, {"source": 53, "target": 5, "value": 1}, {"source": 50, "target": 54, "value": 1}, {"source": 54, "target": 4, "value": 1}, {"source": 54, "target": 52, "value": 1}, {"source": 50, "target": 55, "value": 1}, {"source": 55, "target": 4, "value": 1}, {"source": 55, "target": 5, "value": 1}, {"source": 55, "target": 52, "value": 1}, {"source": 50, "target": 56, "value": 1}, {"source": 56, "target": 4, "value": 1}, {"source": 56, "target": 52, "value": 1}, {"source": 57, "target": 58, "value": 1}, {"source": 57, "target": 59, "value": 1}, {"source": 59, "target": 3, "value": 1}, {"source": 59, "target": 4, "value": 1}, {"source": 59, "target": 5, "value": 1}, {"source": 57, "target": 60, "value": 1}, {"source": 57, "target": 1, "value": 1}, {"source": 57, "target": 61, "value": 1}, {"source": 62, "target": 63, "value": 1}, {"source": 62, "target": 64, "value": 1}, {"source": 62, "target": 65, "value": 1}, {"source": 62, "target": 66, "value": 1}, {"source": 66, "target": 3, "value": 1}, {"source": 66, "target": 4, "value": 1}, {"source": 67, "target": 68, "value": 1}, {"source": 68, "target": 4, "value": 1}, {"source": 68, "target": 5, "value": 1}, {"source": 67, "target": 69, "value": 1}, {"source": 69, "target": 4, "value": 1}, {"source": 69, "target": 5, "value": 1}, {"source": 70, "target": 16, "value": 1}, {"source": 70, "target": 71, "value": 1}, {"source": 72, "target": 73, "value": 1}, {"source": 73, "target": 4, "value": 1}, {"source": 73, "target": 5, "value": 1}, {"source": 74, "target": 1, "value": 1}, {"source": 74, "target": 75, "value": 1}, {"source": 75, "target": 3, "value": 1}, {"source": 75, "target": 37, "value": 1}, {"source": 75, "target": 4, "value": 1}, {"source": 74, "target": 76, "value": 1}, {"source": 76, "target": 3, "value": 1}, {"source": 76, "target": 37, "value": 1}, {"source": 76, "target": 4, "value": 1}, {"source": 76, "target": 5, "value": 1}, {"source": 74, "target": 77, "value": 1}, {"source": 77, "target": 37, "value": 1}, {"source": 77, "target": 5, "value": 1}, {"source": 78, "target": 79, "value": 1}, {"source": 80, "target": 81, "value": 1}, {"source": 80, "target": 82, "value": 1}, {"source": 82, "target": 3, "value": 1}, {"source": 82, "target": 4, "value": 1}, {"source": 80, "target": 83, "value": 1}, {"source": 83, "target": 3, "value": 1}, {"source": 83, "target": 4, "value": 1}, {"source": 83, "target": 12, "value": 1}]};
        const width = window.innerWidth;
        const height = 2000; // Large height for readability

        const svg = d3.select("#chart").append("svg")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", "translate(20,20)");

        const sankey = d3.sankey()
            .nodeWidth(15)
            .nodePadding(10)
            .extent([[0, 0], [width - 40, height - 40]]);

        const {nodes, links} = sankey(data);

        const colorMap = {
            'order': '#44ff44',
            'family': '#4444ff',
            'modality': '#ff4444'
        };

        svg.append("g")
            .selectAll("rect")
            .data(nodes)
            .join("rect")
            .attr("x", d => d.x0)
            .attr("y", d => d.y0)
            .attr("height", d => d.y1 - d.y0)
            .attr("width", d => d.x1 - d.x0)
            .attr("fill", d => colorMap[d.type] || "#ccc")
            .append("title").text(d => d.name);

        svg.append("g")
            .attr("fill", "none")
            .selectAll("path")
            .data(links)
            .join("path")
            .attr("d", d3.sankeyLinkHorizontal())
            .attr("stroke", "#555")
            .attr("stroke-width", d => Math.max(1, d.width))
            .attr("class", "link");

        svg.append("g")
            .selectAll("text")
            .data(nodes)
            .join("text")
            .attr("x", d => d.x0 < width / 2 ? d.x1 + 6 : d.x0 - 6)
            .attr("y", d => (d.y1 + d.y0) / 2)
            .attr("dy", "0.35em")
            .attr("text-anchor", d => d.x0 < width / 2 ? "start" : "end")
            .text(d => d.name);
    </script>
</body>
</html>
    